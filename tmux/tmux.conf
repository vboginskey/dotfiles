# OSX-specific configuration
if-shell "[ $(uname) = "Darwin" ]" "source-file ~/.tmux-osx.conf"

# Source Tmuxline configuration
if-shell "[ -f ~/.tmuxline.conf ]" "source-file ~/.tmuxline.conf"

# 256 colors
set -g default-terminal "screen-256color"

# CTRL+A prefix, like screen
unbind-key C-b
set -g prefix C-a
bind-key C-a send-prefix

# Pane movement uses Vim keys without repeating
unbind-key l
unbind-key Up
unbind-key Down
unbind-key Left
unbind-key Right
bind-key k select-pane -U
bind-key j select-pane -D
bind-key h select-pane -L
bind-key l select-pane -R

# Remap last-window to Space
unbind-key Space
bind-key Space last-window

# Reload config hotkey
bind-key r source-file ~/.tmux.conf\; display-message "Configuration reloaded."

# Better window renaming
bind-key , command-prompt -p "Enter window name:" "rename-window '%%'"
bind-key < set automatic-rename

# Open new windows in same directory
bind-key c new-window -c "#{pane_current_path}"
bind-key % split-window -h -c "#{pane_current_path}"
bind-key '"' split-window -v -c "#{pane_current_path}"

# Number windows starting at 1
set -g base-index 1

# Renumber windows automatically
set -g renumber-windows on

# Fix annoying delay
set -s escape-time 0

# Enable mouse control
set -g mouse on

# Set mouse to behave like <2.1 times
bind-key -n WheelUpPane if-shell -Ft {mouse} "#{mouse_any_flag}"\
  "send-keys -M; send-keys -M; send-keys -M"\
  "if-shell -Ft {mouse} '#{pane_in_mode}'\
    'send-keys -M; send-keys -M; send-keys -M'\
    'select-pane -t {mouse}; copy-mode -e; send-keys -M; send-keys -M; send-keys -M'"
bind-key -n WheelDownPane select-pane -t {mouse}\; send-keys -M\; send-keys -M\; send-keys -M

# Lots of scrollback
set -g history-limit 8192
